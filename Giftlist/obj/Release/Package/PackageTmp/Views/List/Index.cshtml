@model Giftlist.Models.ListModel

@{
	ViewBag.Title = "Lists";
}
<!DOCTYPE html>
<head>
	<title>The Lists</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<script src="~/Scripts/jquery-1.10.2.js"></script>
	<script src="~/Scripts/GiftList.js"></script>
	<link href="~/Assets/Style.css" rel="stylesheet" />
	<link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Allura' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Neucha' rel='stylesheet' type='text/css'>
	<script language="javascript">
		$(function () {
			$('.FamilyMember').click(function () {
				ShowList($(this).attr('data-id'));
				$('.FamilyMember').removeClass('Selected');
				$(this).addClass('Selected');
				//$('.ResponsiveMenu').is(':visible') ? $('.NavSidebar').hide() : $('.NavSidebar').show();
				$('.NavSidebar').removeClass('Opened');
			});

			//Use delegate method here so that the event gets attached to elements that do not exists at page load:
			$(document).on('click', '.ShowClaimForm', function () {
				$('#hdnItemId').val($(this).attr('data-id'));
				$('#Popup').fadeIn(200);
			});

			$(document).on('mouseover', '.ClaimComment', function () {
				var $el = $('#Comment' + $(this).attr('data-id'));
				var poffset = $el.parent().offset();
				var eloffset = $el.offset();
				$el
					.offset({ top: poffset.top + 20, left: poffset.left - 220 })
					.css('visibility', 'visible');
			});

			$(document).on('mouseout', '.ClaimComment', function () {
				var $el = $('#Comment' + $(this).attr('data-id'));
				$el.css('visibility', 'hidden');
			});

			$('#Popup').click(function () {
				$(this).fadeOut(200);
			});

			$('#PopupBox').click(function (event) {
				//stop event from bubbling up to parent, else it fades out:
				event.stopPropagation();
			});

			$('.ResponsiveMenu').click(function (event) {
				//$('.NavSidebar').show();
				$('.NavSidebar').addClass('Opened');
			});

			ShowList(@HttpContext.Current.Session["CurrentListUserId"]);
		})
	</script>
</head>
<body>
	<div class="ResponsiveMenu">
		
	</div>
	<div class="TopBar">
		<div id="Account">
			<div id="CurrentUserName">@Model.CurrentUserName <span style="font-size: 75%;">▼</span></div>
			<div id="AccountOptions">
				<ul>
					<li><a href="./Home/ChangePassword">Change Password</a></li>
					<li><a href="./Home/Logout">Logout</a></li>
				</ul>
			</div>
		</div>
	</div>

	<div class="TheRest">
		<div class="NavSidebar float-left">
			<div class="TitleBar">
				<div class="Title">
					<img src="~/Assets/Images/Tree3_half.png" alt="Small Tree" />
				</div>
			</div>
			<ul>
				@foreach (var item in Model.FamilyMembers)
				{
					<li>
						@*@Html.ActionLink(item.FName, "GetListByUserId", "List", new { UserId = item.UserId }, null );*@
						<a class="FamilyMember" data-id="@item.UserId">@item.FName</a>
					</li>
				}
			</ul>
		</div>

		<div style="height: 100%;">
			<div class="Content float-right"></div>
		</div>
	</div>
	@using (Html.BeginForm())
	{
		<div id="Popup">
			<div id="PopupBox">
				<div class="Title">Claim this gift</div>
				<p>You can claim this gift, which means you intend to give it to the owner of this list.  If you want to claim only a part of this gift, please make a comment so everyone else knows what part.  Please enter the information below:</p>
				<div class="formlabel float-left">Claim type:</div><div class="forminput float-left">@Html.DropDownListFor(m => m.itemClaim.ClaimType, Giftlist.DataAccess.DALists.ClaimTypes)</div>
				<div class="formlabel float-left">Comment:</div><div class="forminput float-left">@Html.TextBoxFor(m => m.itemClaim.Comment, new { @class = "TextboxFieldWide" })</div>
				<div class="formlabel float-left"></div><div class="forminput float-left"><input type="submit" value="Submit"></div>
				@Html.Hidden("hdnItemId")
			</div>
		</div>
	}

	@*<div class="ChangePasswordPartial">
			@Html.Partial("~/Views/Home/ChangePasswordPartial.cshtml", new Giftlist.Models.ChangePasswordModel())
		</div>*@
</body>